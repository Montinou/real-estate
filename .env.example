# =============================================================================
# Real Estate Platform - Environment Variables
# Updated: November 11, 2025
# Stack: Neon + Stack Auth + Upstash + Vercel + R2 + ImageKit
# =============================================================================

# -----------------------------------------------------------------------------
# DATABASE (Neon PostgreSQL with PostGIS)
# Get from: https://console.neon.tech
# Already configured in your .env.local
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://neondb_owner:password@ep-xxx-pooler.region.aws.neon.tech/neondb?sslmode=require
DATABASE_URL_UNPOOLED=postgresql://neondb_owner:password@ep-xxx.region.aws.neon.tech/neondb?sslmode=require
NEON_PROJECT_ID=your-project-id
NEON_PROP_TECH_API_KEY=napi_xxxxx  # For MCP server access (also NEON_API_KEY)

# Alternative format (auto-generated by Neon integration)
POSTGRES_URL=postgresql://neondb_owner:password@ep-xxx-pooler.region.aws.neon.tech/neondb?sslmode=require
POSTGRES_URL_NON_POOLING=postgresql://neondb_owner:password@ep-xxx.region.aws.neon.tech/neondb?sslmode=require
POSTGRES_PRISMA_URL=postgresql://neondb_owner:password@ep-xxx-pooler.region.aws.neon.tech/neondb?connect_timeout=15&sslmode=require

PGHOST=ep-xxx-pooler.region.aws.neon.tech
PGDATABASE=neondb
PGUSER=neondb_owner
PGPASSWORD=your-password

# -----------------------------------------------------------------------------
# AUTHENTICATION (Stack Auth via Neon Auth)
# Get from: Stack Auth dashboard or Neon Console > Auth tab
# Already configured in your .env.local
# -----------------------------------------------------------------------------
NEXT_PUBLIC_STACK_PROJECT_ID=your-project-id
NEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY=pck_xxxxx
STACK_SECRET_SERVER_KEY=ssk_xxxxx

# -----------------------------------------------------------------------------
# CACHE & QUEUE (Upstash Redis + QStash)
# Get from: https://console.upstash.com or Vercel integration
# Already configured in your .env.local
# -----------------------------------------------------------------------------
# Redis (for caching, rate limiting, sessions)
# Note: KV_REST_API_URL and KV_REST_API_TOKEN are also used by Upstash MCP server
KV_REST_API_URL=https://your-redis.upstash.io
KV_REST_API_TOKEN=your-token
KV_REST_API_READ_ONLY_TOKEN=your-readonly-token
KV_URL=rediss://default:token@your-redis.upstash.io:6379
REDIS_URL=rediss://default:token@your-redis.upstash.io:6379

# QStash (for job queues and CRON)
QSTASH_URL=https://qstash.upstash.io
QSTASH_TOKEN=your-token
QSTASH_CURRENT_SIGNING_KEY=sig_xxx
QSTASH_NEXT_SIGNING_KEY=sig_xxx

# -----------------------------------------------------------------------------
# IMAGE STORAGE (Cloudflare R2)
# Get from: https://dash.cloudflare.com → R2
# Free tier: 10 GB storage, unlimited egress
# -----------------------------------------------------------------------------
CLOUDFLARE_ACCOUNT_ID=your-account-id
R2_BUCKET_NAME=property-images
R2_ACCESS_KEY_ID=your-access-key
R2_SECRET_ACCESS_KEY=your-secret-key
R2_PUBLIC_URL=https://pub-xxxxx.r2.dev
R2_ENDPOINT=https://xxxxx.r2.cloudflarestorage.com

# -----------------------------------------------------------------------------
# IMAGE CDN (ImageKit.io)
# Get from: https://imagekit.io → Dashboard
# Free tier: 20 GB storage, 20 GB bandwidth, unlimited transforms
# -----------------------------------------------------------------------------
NEXT_PUBLIC_IMAGEKIT_URL_ENDPOINT=https://ik.imagekit.io/your-id
NEXT_PUBLIC_IMAGEKIT_PUBLIC_KEY=public_xxx
IMAGEKIT_PRIVATE_KEY=private_xxx

# Image Processing Settings
IMAGE_QUALITY_THUMBNAIL=80
IMAGE_QUALITY_CARD=85
IMAGE_QUALITY_GALLERY=90
IMAGE_QUALITY_FULL=90
IMAGE_MAX_WIDTH=1920
IMAGE_FORMAT=webp
GENERATE_BLURHASH=true

# -----------------------------------------------------------------------------
# AI SERVICES
# -----------------------------------------------------------------------------

# Vercel AI Gateway (Already configured)
AI_GATEWAY_API_KEY=vck_xxxxx

# Google Gemini (Text generation, property descriptions)
# Get from: https://aistudio.google.com/apikey
# Free tier: 1,000 requests/day (30K/month)
GEMINI_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Groq (Fast LLM for chatbot) - Already configured
GROQ_API_KEY=gsk_xxxxx

# Hugging Face (Embeddings for semantic search) - Already configured
HUGGINGFACE_TOKEN=hf_xxxxx
HUGGINGFACESW_API_KEY=hf_xxxxx

# OpenAI (Optional - for comparison)
OPENAI_API_KEY=sk-xxxxx

# Anthropic Claude (Optional)
ANTHROPIC_API_KEY=sk-ant-xxxxx

# -----------------------------------------------------------------------------
# ERROR TRACKING (Sentry)
# Get from: https://sentry.io → Settings → Projects
# Already configured in your .env.local
# -----------------------------------------------------------------------------
NEXT_PUBLIC_SENTRY_DSN=https://xxxxx@xxxxx.ingest.us.sentry.io/xxxxx
SENTRY_AUTH_TOKEN=your-auth-token
SENTRY_ORG=your-org
SENTRY_PROJECT=your-project

# -----------------------------------------------------------------------------
# MONITORING & LOGGING
# -----------------------------------------------------------------------------

# Highlight.io (Logging, 1M logs/month free)
# Get from: https://app.highlight.io
NEXT_PUBLIC_HIGHLIGHT_PROJECT_ID=your-project-id

# Checkly (Uptime monitoring, install via Vercel integration)
# No env vars needed - managed through Vercel

# Vercel Analytics (Built-in, just enable in dashboard)
# No env vars needed

# -----------------------------------------------------------------------------
# MERCADOLIBRE API (Real estate scraping)
# Get from: https://developers.mercadolibre.com.ar
# Already configured in your .env.local
# -----------------------------------------------------------------------------
ML_APP_ID=your-app-id
ML_APP_SECRET_KEY=your-secret-key
ML_CLIENT_ID=your-client-id
ML_CLIENT_SECRET=your-client-secret
ML_ACCESS_TOKEN=your-access-token
ML_REFRESH_TOKEN=your-refresh-token
ML_REDIRECT_URI=https://your-app.vercel.app/api/auth/mercadolibre/callback

# -----------------------------------------------------------------------------
# GOOGLE CLOUD (Properati BigQuery - Optional)
# Get from: https://console.cloud.google.com
# -----------------------------------------------------------------------------
GCP_PROJECT_ID=your-project-id
GCP_KEY_FILE=/path/to/service-account-key.json
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account-key.json

# -----------------------------------------------------------------------------
# VERCEL CONFIGURATION
# Auto-injected by Vercel, no manual setup needed
# -----------------------------------------------------------------------------
VERCEL=1
VERCEL_ENV=production  # or preview, development
VERCEL_URL=your-app.vercel.app
VERCEL_OIDC_TOKEN=auto-generated

# -----------------------------------------------------------------------------
# APPLICATION SETTINGS
# -----------------------------------------------------------------------------

# Environment
NODE_ENV=production  # or development, test
NEXT_PUBLIC_APP_URL=https://your-app.vercel.app
PORT=3000

# Security
JWT_SECRET=your-jwt-secret-here-change-in-production
JWT_EXPIRES_IN=7d
NEXTAUTH_SECRET=your-nextauth-secret-here
NEXTAUTH_URL=https://your-app.vercel.app

# CORS
CORS_ORIGINS=https://your-app.vercel.app,https://your-custom-domain.com

# -----------------------------------------------------------------------------
# SCRAPING CONFIGURATION
# -----------------------------------------------------------------------------

# User Agent
USER_AGENT=RealEstateAggregator/1.0 (+https://your-app.vercel.app; contact@email.com)

# Enabled Sources
ENABLE_MERCADOLIBRE=true
ENABLE_PROPERATI=true
ENABLE_ZONAPROP=false
ENABLE_ARGENPROP=false
ENABLE_INMUEBLES24=false

# Rate Limiting (be respectful!)
MAX_CONCURRENT_SCRAPERS=1
REQUEST_DELAY_MIN=2000
REQUEST_DELAY_MAX=5000
RATE_LIMIT_REQUESTS_PER_SECOND=0.5
RATE_LIMIT_REQUESTS_PER_HOUR=1200
RATE_LIMIT_REQUESTS_PER_DAY=10000

# -----------------------------------------------------------------------------
# SCHEDULING (QStash CRON format)
# Configure via Upstash Console or API
# -----------------------------------------------------------------------------
SCHEDULE_MERCADOLIBRE=0 */6 * * *  # Every 6 hours
SCHEDULE_PROPERATI=0 4 * * 0       # Sundays at 4 AM
SCHEDULE_ZONAPROP=0 3 * * *        # Daily at 3 AM
SCHEDULE_DEDUPLICATION=0 6 * * 0   # Sundays at 6 AM
SCHEDULE_CLEANUP=0 2 * * *         # Daily at 2 AM

# -----------------------------------------------------------------------------
# GEOCODING
# -----------------------------------------------------------------------------
GEOCODING_SERVICE=nominatim  # Options: nominatim, google, mapbox
NOMINATIM_URL=https://nominatim.openstreetmap.org
GEOCODING_CACHE_TTL=2592000  # 30 days in seconds

# Google Maps Geocoding API (Optional, paid)
GOOGLE_MAPS_API_KEY=your-api-key

# Mapbox Geocoding API (Optional, has free tier)
MAPBOX_ACCESS_TOKEN=your-token

# -----------------------------------------------------------------------------
# FEATURE FLAGS
# -----------------------------------------------------------------------------
ENABLE_IMAGE_DOWNLOAD=true
ENABLE_GEOCODING=true
ENABLE_DEDUPLICATION=true
ENABLE_PRICE_HISTORY=true
ENABLE_API=true
ENABLE_SCHEDULER=true
ENABLE_AI_DESCRIPTIONS=true
ENABLE_AI_CHATBOT=true
ENABLE_SEMANTIC_SEARCH=true

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
LOG_LEVEL=info  # Options: error, warn, info, http, verbose, debug, silly
DEBUG=false
VERBOSE_LOGGING=false

# -----------------------------------------------------------------------------
# DEPRECATED / NOT USED (kept for reference)
# -----------------------------------------------------------------------------

# OLD: Local storage (replaced by R2 + ImageKit)
# STORAGE_TYPE=local
# STORAGE_PATH=/path/to/local/storage
# USE_MINIO=false
# MINIO_ENDPOINT=localhost
# MINIO_PORT=9000
# MINIO_ACCESS_KEY=minioadmin
# MINIO_SECRET_KEY=minioadmin

# OLD: Supabase (replaced by Neon + Stack Auth)
# SUPABASE_URL=https://xxx.supabase.co
# SUPABASE_ANON_KEY=your-anon-key
# SUPABASE_SERVICE_KEY=your-service-key

# OLD: Local Redis (replaced by Upstash)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=

# OLD: pg-boss (replaced by QStash)
# QUEUE_TYPE=pgboss

# OLD: PM2 (not needed on Vercel)
# PM2_MAX_MEMORY_RESTART=1G
# PM2_INSTANCES=2
# PM2_EXEC_MODE=cluster

# =============================================================================
# QUICK SETUP CHECKLIST
# =============================================================================
#
# ✅ Already Configured (from your .env.local):
# - Neon Database (DATABASE_URL, NEON_PROJECT_ID)
# - Stack Auth (STACK_* variables)
# - Upstash Redis + QStash (KV_*, QSTASH_* variables)
# - Sentry (SENTRY_* variables)
# - Groq AI (GROQ_API_KEY)
# - Hugging Face (HUGGINGFACE* variables)
# - MercadoLibre (ML_* variables)
# - Vercel AI Gateway (AI_GATEWAY_API_KEY)
#
# ❌ Still Need to Configure:
# 1. Cloudflare R2 (R2_* variables)
#    → Sign up: https://dash.cloudflare.com
#    → Create R2 bucket
#    → Generate API token
#
# 2. ImageKit.io (IMAGEKIT_* variables)
#    → Sign up: https://imagekit.io
#    → Get credentials from Dashboard
#    → Add R2 as external storage origin
#
# 3. Google Gemini (GEMINI_API_KEY)
#    → Get API key: https://aistudio.google.com/apikey
#    → Free tier: 30K requests/month
#
# 4. Highlight.io (HIGHLIGHT_PROJECT_ID)
#    → Sign up: https://app.highlight.io
#    → Create project
#    → Get project ID
#
# 5. Checkly (via Vercel integration)
#    → Run: vercel integration add checkly
#    → No env vars needed
#
# 6. Google Cloud (GCP_* - Optional for Properati)
#    → Only if using Properati BigQuery dataset
#
# =============================================================================
# COPY TO VERCEL
# =============================================================================
#
# After configuring, add to Vercel:
#
# Method 1: Using Vercel CLI
# vercel env add GEMINI_API_KEY production
# vercel env add R2_ACCESS_KEY_ID production
# (repeat for all new variables)
#
# Method 2: Using Vercel Dashboard
# https://vercel.com/your-project/settings/environment-variables
#
# Method 3: Using setup script
# ./scripts/setup-vercel-complete.sh
#
# =============================================================================
